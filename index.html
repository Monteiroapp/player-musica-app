<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Player de M√∫sica PWA</title>
<link rel="manifest" href="manifest.json">
<meta name="theme-color" content="#ff9800">
<style>
body{font-family:Arial,sans-serif;background:linear-gradient(135deg,#1e1e2f,#2c3e50);color:#fff;text-align:center;padding:20px;margin:0}
h1{margin-bottom:20px;font-size:1.8em;display:flex;align-items:center;justify-content:center;gap:8px}
.player{background:#2a2a3d;padding:15px;border-radius:15px;box-shadow:0px 5px 15px rgba(0,0,0,.5);max-width:420px;margin:auto;box-sizing:border-box;width:100%}
.cover{width:100%;max-width:300px;border-radius:15px;margin:15px auto;object-fit:cover;box-shadow:0px 5px 15px rgba(0,0,0,.5)}
audio{display:none}
.controls{margin-top:15px;display:flex;flex-wrap:wrap;justify-content:center;gap:10px}
button{background:#ff9800;border:none;padding:12px 18px;border-radius:10px;cursor:pointer;font-weight:bold;font-size:1em;transition:.3s;flex:1 1 100px;max-width:140px;user-select:none}
button:hover{background:#e68900}
button.active{background:#4caf50;color:#fff}
ul{list-style:none;padding:0;margin-top:20px;max-height:160px;overflow-y:auto}
li{padding:12px 10px;margin:6px 0;background:#3b3b5c;border-radius:8px;cursor:pointer;transition:.3s;font-size:1em}
li:hover{background:#505072}
li.active{background:#ff9800;color:#000;font-weight:bold}
input[type=file]{margin-top:15px;padding:10px;border-radius:8px;background:#fff;color:#000;width:100%;box-sizing:border-box;font-size:1em}
#infoMusica{margin-top:10px;font-size:1em;color:#ddd;min-height:1.2em}
.progress-container{background:#444;border-radius:10px;height:12px;margin:15px 0;cursor:pointer;position:relative}
.progress{background:#ff9800;height:100%;width:0%;border-radius:10px;transition:width .2s}
.time{display:flex;justify-content:space-between;font-size:14px;margin-top:-4px}
</style>
</head>
<body>
<h1><img src="icons/icon-192.png" alt="√çcone Player" style="width:80px;height:80px;">Player de M√∫sica PWA</h1>
<div class="player">
<img id="capaMusica" class="cover" src="https://via.placeholder.com/250x250?text=Capa+Indispon√≠vel" alt="Capa do √Ålbum" />
<h3 id="musicaTitulo">Nenhuma m√∫sica selecionada</h3>
<p id="infoMusica"></p>
<div class="progress-container" id="progressContainer"><div class="progress" id="progress"></div></div>
<div class="time"><span id="tempoAtual">0:00</span><span id="tempoTotal">0:00</span></div>
<audio id="audio"></audio>
<div class="controls">
<button onclick="prevMusica()">‚èÆ Anterior</button>
<button onclick="playPause()">‚èØ Play/Pause</button>
<button onclick="nextMusica()">‚è≠ Pr√≥xima</button>
<button id="shuffleBtn" onclick="toggleShuffle()">üîÄ Shuffle</button>
<button id="repeatBtn" onclick="toggleRepeat()">üîÅ Repeat</button>
</div>
<p>Selecione m√∫sicas (MP3):</p>
<input type="file" id="uploadMusicas" multiple accept="audio/*" />
<ul id="listaMusicas"></ul>
</div>
<script src="https://cdn.jsdelivr.net/npm/jsmediatags@3.9.7/dist/jsmediatags.min.js"></script>
<script>
const audio=document.getElementById("audio");audio.volume=1;
const musicaTitulo=document.getElementById("musicaTitulo"),capaMusica=document.getElementById("capaMusica"),listaMusicas=document.getElementById("listaMusicas"),uploadMusicas=document.getElementById("uploadMusicas"),infoMusica=document.getElementById("infoMusica"),progressContainer=document.getElementById("progressContainer"),progress=document.getElementById("progress"),tempoAtualEl=document.getElementById("tempoAtual"),tempoTotalEl=document.getElementById("tempoTotal"),shuffleBtn=document.getElementById("shuffleBtn"),repeatBtn=document.getElementById("repeatBtn");
let musicas=[],musicaAtual=0,shuffle=!1,repeat=!1;
function carregarMusica(e){musicaAtual=e;const t=musicas[e];audio.src=URL.createObjectURL(t.file),musicaTitulo.textContent=t.titulo,infoMusica.textContent=`${t.artista||"Artista desconhecido"} ‚Ä¢ ${t.album||"√Ålbum desconhecido"}`,capaMusica.src=t.capa||"https://via.placeholder.com/250x250?text=Capa+Indispon√≠vel",audio.play();const a=listaMusicas.getElementsByTagName("li");for(let r=0;r<a.length;r++)a[r].classList.remove("active");a[e].classList.add("active")}
function playPause(){audio.paused?audio.play():audio.pause()}
function nextMusica(){if(0!==musicas.length)if(repeat)carregarMusica(musicaAtual);else if(shuffle){let e;do{e=Math.floor(Math.random()*musicas.length)}while(e===musicaAtual&&musicas.length>1);carregarMusica(e)}else musicaAtual=(musicaAtual+1)%musicas.length,carregarMusica(musicaAtual)}
function prevMusica(){0!==musicas.length&&(musicaAtual=(musicaAtual-1+musicas.length)%musicas.length,carregarMusica(musicaAtual))}
function toggleShuffle(){shuffle=!shuffle,shuffleBtn.classList.toggle("active",shuffle)}
function toggleRepeat(){repeat=!repeat,repeatBtn.classList.toggle("active",repeat)}
audio.addEventListener("timeupdate",()=>{if(audio.duration){const e=audio.currentTime/audio.duration*100;progress.style.width=`${e}%`,tempoAtualEl.textContent=formatarTempo(audio.currentTime),tempoTotalEl.textContent=formatarTempo(audio.duration)}});
progressContainer.addEventListener("click",e=>{const t=progressContainer.clientWidth,a=e.offsetX,r=audio.duration;audio.currentTime=a/t*r});
function formatarTempo(e){const t=Math.floor(e/60);return`${t}:${Math.floor(e%60).toString().padStart(2,"0")}`}
function extrairCapa(e){if(e.picture){const{data:t,format:a}=e.picture;let r="";const o=new Uint8Array(t);for(let c=0;c<o.length;c++)r+=String.fromCharCode(o[c]);return`data:${a};base64,${btoa(r)}`}return null}
uploadMusicas.addEventListener("change",e=>{const t=Array.from(e.target.files);musicas=[],t.forEach((e,t)=>{const a={titulo:e.name,artista:null,album:null,file:e,capa:"https://via.placeholder.com/250x250?text=Capa+Indispon√≠vel"};jsmediatags.read(e,{onSuccess:e=>{e.tags.title&&(a.titulo=e.tags.title),e.tags.artist&&(a.artista=e.tags.artist),e.tags.album&&(a.album=e.tags.album);const t=extrairCapa(e.tags);t&&(a.capa=t),atualizarLista()},onError:()=>atualizarLista()}),musicas.push(a)});
function atualizarLista(){listaMusicas.innerHTML="",musicas.forEach((e,t)=>{const a=document.createElement("li");a.textContent="üéµ "+e.titulo,a.onclick=()=>carregarMusica(t),listaMusicas.appendChild(a)}),musicas.length>0&&""===audio.src&&carregarMusica(0)}});
audio.addEventListener("ended",nextMusica);
</script>
<script>if("serviceWorker"in navigator){navigator.serviceWorker.register("sw.js").then(e=>console.log("SW registrado:",e.scope)).catch(e=>console.log("Falha SW:",e))}</script>
</body></html>